import{_ as V}from"./index-DGmxUNP7.js";function f(e){return/^[A-Za-z_][A-Za-z0-9_]*$/.test(e)?!["abstract","arguments","await","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield"].includes(e):!1}function g(e){if(!e.startsWith("data:image/"))return"Invalid base64 string";const a=e.substring(e.indexOf("image/")+6,e.indexOf(";"));switch(a){case"svg+xml":return"svg";case"x-icon":return"ico";case"vnd.microsoft.icon":return"ico";default:return a}}function h({base64:e,name:a="image",mimeType:n}){let r=document.createElement("a");r.href=e,r.download=`${a}.${n??g(e)}`,r.click(),r.remove()}function v(e,a={}){const{name:n="image_",mimeType:r,chunkSize:s=5}=a;let o=1,u=0;const i=_.chunk(e,s),d=setInterval(()=>{i[u].forEach(c=>{h({base64:c,name:`${n}_${o}`,mimeType:r}),o++}),u+=1,u>i.length-1&&clearInterval(d)},1e3)}function x(e){return typeof e!="string"||e.trim().length===0?!1:/^data:image\/(png|jpeg|gif|bmp|svg\+xml);base64,(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}const p=e=>(Vue.pushScopeId("data-v-04f7a212"),e=e(),Vue.popScopeId(),e),b=p(()=>Vue.createElementVNode("div",{class:"text-2xl mb-6"},"批量下载 base64 图",-1)),w={class:"shadow-2xl border rounded-xl w-full h-full max-w-[1280px] p-4 flex items-start flex-col gap-3"},y={class:"w-full flex justify-between items-center h-8"},E={class:"grid grid-cols-3 grid-rows-2 mt-4 px-4 gap-y-4 gap-x-4 w-full",style:{"justify-self":"end"}},N={class:"flex gap-3 items-center"},I={class:"flex gap-3 items-center"},k=p(()=>Vue.createElementVNode("div",{class:"mt-auto mx-auto"},[Vue.createElementVNode("span",{class:"text-sm text-gray-400"},"ps: 编辑器最外层仅能为数组格式，否则程序将会无法使用")],-1)),z=Vue.defineComponent({__name:"base64Img",setup(e){const a=Vue.ref([]),n=Vue.ref(""),r=Vue.ref("image_"),s=Vue.ref(!1),o=Vue.ref(),u=Vue.ref();Vue.onMounted(()=>{o.value&&(u.value=new JSONEditor(o.value,{mode:"code",mainMenuBar:!1,schema:{base64:[]},onChangeText(l){try{const t=JSON.parse(l);a.value=t,s.value=!1}catch{s.value=!0}}}),u.value.setText(`[
  
]`))});const i=Vue.computed(()=>{if(n.value==="")return!1;const l=n.value.split(".");return(l==null?void 0:l.length)<2?!f(n.value):!!l.some(t=>!f(t))}),d=()=>{if(s.value)return alert("您输入的 Json 格式有误，请重新输入");if(i.value)return alert("请按照 a.b.c 的 方式重新输入");if(c.value===0)return alert("当前检测出的图片数量为 0");const l=n.value??"";switch(!0){case l==="":{v(a.value,{name:r.value});return}default:{v(a.value.map(t=>_.get(t,l)),{name:r.value});return}}},c=Vue.computed(()=>{if(s.value||i.value)return 0;const l=a.value.map(t=>_.get(t,n.value));return(n.value===""?a.value:l).filter(t=>x(t)).length});return(l,t)=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[b,Vue.createElementVNode("div",w,[Vue.createElementVNode("div",y,[Vue.createElementVNode("div",null,"当前数可下载图片数量: "+Vue.toDisplayString(c.value),1),Vue.createElementVNode("div",{class:"flex items-centr gap-4 h-full"},[Vue.createElementVNode("button",{class:"h-full px-4 bg-blue-500 hover:bg-blue-600 active:bg-blue-700 transition-all text-white rounded-md",onClick:d},"下载")])]),Vue.createElementVNode("div",{class:"JSON-Editor",ref_key:"jsonRef",ref:o},null,512),Vue.createElementVNode("div",E,[Vue.createElementVNode("div",N,[Vue.createTextVNode(" 名称前缀: "),Vue.withDirectives(Vue.createElementVNode("input",{class:Vue.normalizeClass("border h-9 w-40 border-cyan-400 rounded-md px-2"),type:"text",placeholder:"例: user","onUpdate:modelValue":t[0]||(t[0]=m=>r.value=m)},null,512),[[Vue.vModelText,r.value]])]),Vue.createElementVNode("div",I,[Vue.createTextVNode(" 属性层级: "),Vue.withDirectives(Vue.createElementVNode("input",{class:Vue.normalizeClass(`border h-9 w-40 border-cyan-400 rounded-md px-2 ${i.value?"outline-red-600 outline-2 outline outline-offset-[-2px]":""}`),type:"text",placeholder:"例: a.b.c","onUpdate:modelValue":t[1]||(t[1]=m=>n.value=m)},null,2),[[Vue.vModelText,n.value]])])]),k])],64))}}),B=V(z,[["__scopeId","data-v-04f7a212"]]);export{B as default};

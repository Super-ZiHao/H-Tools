import{_ as h}from"./index-BGpbkgKW.js";function f(e){return/^[A-Za-z_][A-Za-z0-9_]*$/.test(e)?!["abstract","arguments","await","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield"].includes(e):!1}function g(e){if(!e.startsWith("data:image/"))return"Invalid base64 string";const t=e.substring(e.indexOf("image/")+6,e.indexOf(";"));switch(t){case"svg+xml":return"svg";case"x-icon":return"ico";case"vnd.microsoft.icon":return"ico";default:return t}}function V(e,t){if(typeof e!="string"||e.trim().length===0)return!1;const a=/^data:[a-z]+\/[a-z]+(;[a-z-]+=?)?(,|$)/i;if(!e.match(a))return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/.test(e);switch(t){case"img":return/^data:image\/(png|jpeg|gif|bmp|svg\+xml);base64,(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e);case"audio":return/^data:audio\/(mpeg|aac|ogg|wav|x-flac|x-ms-wma|midi|amr|awb|x-wavpack|mp4|aac+|eaac+);base64,/.test(e);case"video":return/^data:video\/(mp4|avi|mkv|ogg|webm|quicktime|wmv|x-flv|3gp|3gpp|mpeg|hevc|h265|);base64,/.test(e);default:{const n=e.substring(e.indexOf(",")+1);return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/.test(n)}}}function x({url:e,name:t="image",mimeType:a}){let n=document.createElement("a");V(e)?(n.href=e,n.download=`${t}.${a??g(e)}`,n.click(),n.remove()):fetch(e).then(r=>{if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.blob()}).then(r=>{const s=window.URL.createObjectURL(r),o=document.createElement("a");o.style.display="none",o.href=s,o.download=`${t}.${r.type.split("/")[1]}`,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(s),document.body.removeChild(o)})}function p(e,t={}){const{name:a="image_",mimeType:n,chunkSize:r=5}=t;let s=1,o=0;const i=_.chunk(e,r),m=setInterval(()=>{i[o].forEach(d=>{x({url:d,name:`${a}_${s}`,mimeType:n}),s++}),o+=1,o>i.length-1&&clearInterval(m)},1e3)}const v=e=>(Vue.pushScopeId("data-v-99e02f66"),e=e(),Vue.popScopeId(),e),w=v(()=>Vue.createElementVNode("div",{class:"text-2xl mb-6"},"文件下载（base64、url）",-1)),b={class:"shadow-2xl border rounded-xl w-full h-full max-w-[1440px] p-4 flex items-start flex-col gap-3"},y={class:"w-full flex justify-between items-center h-8"},E={class:"flex items-centr gap-1 h-full"},N={class:"flex mt-4 gap-4 w-full",style:{"justify-self":"end"}},k=v(()=>Vue.createElementVNode("div",{class:"mt-auto mx-auto"},[Vue.createElementVNode("span",{class:"text-sm text-gray-400"},"ps: 编辑器最外层仅能为数组格式，否则程序将会无法使用")],-1)),z=Vue.defineComponent({__name:"base64Img",setup(e){const t=Vue.ref([]),a=Vue.ref(""),n=Vue.ref("image_"),r=Vue.ref(!1),s=Vue.ref(),o=Vue.ref();Vue.onMounted(()=>{s.value&&(o.value=new JSONEditor(s.value,{mode:"code",mainMenuBar:!1,schema:{base64:[]},onChangeText(u){try{const l=JSON.parse(u);t.value=l,r.value=!1}catch{r.value=!0}}}),o.value.setText(`[
  
]`))});const i=Vue.computed(()=>{if(a.value==="")return!1;const u=a.value.split(".");return(u==null?void 0:u.length)<2?!f(a.value):!!u.some(l=>!f(l))}),m=()=>{switch(!0){case a.value==="":{p(t.value,{name:n.value});return}default:{p(t.value.map(u=>_.get(u,a.value)),{name:n.value});return}}},d=Vue.computed(()=>{if(r.value||i.value)return 0;const u=t.value.map(l=>_.get(l,a.value));return(a.value===""?t.value:u).filter(l=>{try{const c=new URL(l);if(V(l)||c.protocol==="https:")return!0}catch{return!1}}).length});return(u,l)=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[w,Vue.createElementVNode("div",b,[Vue.createElementVNode("div",y,[Vue.createElementVNode("div",null,"识别出可下载数量: "+Vue.toDisplayString(d.value),1),Vue.createElementVNode("div",E,[Vue.createVNode(Vue.unref(ElementPlus.ElButton),null,{default:Vue.withCtx(()=>[Vue.createTextVNode("格式化")]),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElButton),{disabled:r.value||i.value||d.value===0,type:"primary",onClick:m},{default:Vue.withCtx(()=>[Vue.createTextVNode("下载")]),_:1},8,["disabled"])])]),Vue.createElementVNode("div",{class:"JSON-Editor",ref_key:"jsonRef",ref:s},null,512),Vue.createElementVNode("div",N,[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{style:{width:"140px"},modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=c=>n.value=c),placeholder:"例: user"},{prepend:Vue.withCtx(()=>[Vue.createTextVNode("名称前缀")]),_:1},8,["modelValue"]),Vue.createVNode(Vue.unref(ElementPlus.ElInput),{style:{width:"160px"},modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=c=>a.value=c),placeholder:"例: a.b.c"},{prepend:Vue.withCtx(()=>[Vue.createTextVNode("属性层级")]),_:1},8,["modelValue"])]),k])],64))}}),R=h(z,[["__scopeId","data-v-99e02f66"]]);export{R as default};

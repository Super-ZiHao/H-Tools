import{_ as y}from"./index-CwWzF2rp.js";const C=o=>(Vue.pushScopeId("data-v-30d74645"),o=o(),Vue.popScopeId(),o),B=["onDragstart"],F=["src"],G=["innerHTML"],T=C(()=>Vue.createElementVNode("div",{class:"text-white text-lg"},"拖出删除",-1)),m="dragging",f="drop-file",h="dragging-item",M=Vue.defineComponent({__name:"draggable",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const r=Vue.useModel(o,"modelValue"),n=Vue.ref(),D=e=>{e.preventDefault(),n.value.classList.add(f)},x=e=>{e.preventDefault(),e.stopPropagation(),n.value.classList.remove(f)},g=e=>{e.filter(a=>a.type.startsWith("image/")).forEach(a=>{const l=URL.createObjectURL(a),u=new FileReader;u.readAsDataURL(a),u.onload=function(c){var V;const N=c.target.result,R={id:_.uniqueId(),name:a.name,url:l,base64:N,type:a.type};(V=r.value)==null||V.push(R)}})},b=e=>{var a;e.preventDefault(),n.value.classList.remove(f);const t=[...((a=e.dataTransfer)==null?void 0:a.files)??[]];g(t)},s=Vue.ref(),i=Vue.ref(),I=e=>{var t;(t=n.value)==null||t.classList.add(m),setTimeout(()=>{e.target&&e.target.classList.add(h)},0),s.value=e.target,d.value=!0},w=e=>{var c;if(e.preventDefault(),e.target===s.value||e.target===i.value.$el||!s.value)return;const t=Array.from(((c=i.value.$el)==null?void 0:c.children)??[]),a=t.indexOf(s.value),l=t.indexOf(e.target);if(!r.value)return;let u=r.value[a];r.value[a]=r.value[l],r.value[l]=u},E=e=>{var t;(t=n.value)==null||t.classList.remove(m),e.target&&e.target.classList.remove(h),d.value=!1},d=Vue.ref(!1),v=Vue.ref(),k=()=>{var e;(e=r.value)==null||e.splice(r.value.findIndex(t=>t===v.value),1)},L=e=>{const t=e.target;g([...t.files??[]]),t.value=""},p=Vue.ref();return(e,t)=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("div",{class:"relative z-10 bg-white container flex-shrink-0 w-64 rounded-md h-full border-[2px] transition-all border-cyan-400 overflow-auto",onDrop:b,onDragleave:x,onDragover:D,ref_key:"containerRef",ref:n},[Vue.createVNode(Vue.TransitionGroup,{class:"flex relative flex-col gap-2 p-2 w-full mb-9 draggable transition-all",onDragstart:I,onDragenter:w,onDragend:E,ref_key:"labelFileRef",ref:i,name:"list",tag:"div"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(r.value,a=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"draggable-item text-nowrap w-full h-14 p-2 rounded-md select-none text-lg bg-slate-100 flex items-center gap-2 cursor-pointer hover:bg-slate-200 active:bg-slate-300 hover:scale-[1.02] transition-all",onClick:t[0]||(t[0]=l=>{l.stopPropagation(),l.preventDefault()}),draggable:"true",onDragstart:l=>v.value=a,key:a.id},[Vue.createElementVNode("img",{src:a.url,class:"aspect-square h-full rounded-md pointer-events-none",draggable:"false",alt:""},null,8,F),Vue.createElementVNode("div",{class:"text-ellipsis overflow-hidden pointer-events-none",draggable:"false",innerHTML:a.name},null,8,G)],40,B))),128))]),_:1},512),Vue.createVNode(Vue.unref(ElementPlus.ElButton),{class:"upload-btn",type:"success",onClick:t[1]||(t[1]=a=>{var l;return(l=p.value)==null?void 0:l.click()})},{default:Vue.withCtx(()=>[Vue.createTextVNode(" 点击上传 ")]),_:1}),Vue.createElementVNode("input",{class:"hidden",type:"file",accept:".jpg,.jpeg,.png,.gif,.svg",multiple:!0,onChange:L,ref_key:"fileInputRef",ref:p,name:"file"},null,544)],544),Vue.withDirectives(Vue.createElementVNode("div",{class:"mask flex flex-col items-center gap-4 justify-center",onDragover:t[2]||(t[2]=a=>a.preventDefault()),onDrop:k},[Vue.createVNode(Vue.unref(ElementPlus.ElIcon),{size:"36",color:"white"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(ElementPlusIconsVue.Delete))]),_:1}),T],544),[[Vue.vShow,d.value]])],64))}}),A=y(M,[["__scopeId","data-v-30d74645"]]);export{A as D};
